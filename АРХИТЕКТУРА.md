# LOOKLIKEME - –¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

**–î–∞—Ç–∞:** 26 —è–Ω–≤–∞—Ä—è 2026
**–í–µ—Ä—Å–∏—è:** 1.0

---

## üìä –°–•–ï–ú–ê –ë–ê–ó–´ –î–ê–ù–ù–´–• (PostgreSQL + Prisma)

### –ü–æ–ª–Ω–∞—è Prisma Schema:

```prisma
// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ============================================
// –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ò –ò –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø
// ============================================

model User {
  id            String    @id @default(cuid())
  email         String?   @unique
  emailVerified DateTime?
  name          String?
  image         String?

  // –ü–æ–¥–ø–∏—Å–∫–∞
  subscriptionType     SubscriptionType @default(FREE)
  subscriptionEndDate  DateTime?
  lifetimeAccess       Boolean          @default(false)

  // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
  totalGenerations     Int              @default(0)
  createdAt            DateTime         @default(now())
  updatedAt            DateTime         @updatedAt

  // –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞
  referralCode         String           @unique @default(cuid())
  referredBy           String?
  bonusGenerations     Int              @default(0)
  bonusExpiresAt       DateTime?

  // –°–≤—è–∑–∏
  accounts             Account[]
  sessions             Session[]
  generations          Generation[]
  favorites            Favorite[]
  collections          Collection[]
  dailyLimits          DailyLimit[]
  achievements         UserAchievement[]
  stylePreferences     StylePreference[]
  chatMessages         ChatMessage[]

  @@index([email])
  @@index([referralCode])
  @@map("users")
}

enum SubscriptionType {
  FREE
  PREMIUM
  LIFETIME
}

// NextAuth.js tables
model Account {
  id                String  @id @default(cuid())
  userId            String
  type              String
  provider          String
  providerAccountId String
  refresh_token     String? @db.Text
  access_token      String? @db.Text
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String? @db.Text
  session_state     String?

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
  @@index([userId])
  @@map("accounts")
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique
  userId       String
  expires      DateTime
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@map("sessions")
}

model VerificationToken {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
  @@map("verification_tokens")
}

// ============================================
// –°–¢–ò–õ–ò –û–î–ï–ñ–î–´
// ============================================

model Style {
  id              String   @id @default(cuid())
  name            String   @unique
  slug            String   @unique
  description     String   @db.Text
  promptTemplate  String   @db.Text
  isPremium       Boolean  @default(false)
  category        String   // "formal", "casual", "sport", etc.
  iconUrl         String?
  exampleImageUrl String?
  sortOrder       Int      @default(0)
  isActive        Boolean  @default(true)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  // –°–≤—è–∑–∏
  generations     Generation[]
  preferences     StylePreference[]

  @@index([isPremium])
  @@index([isActive])
  @@map("styles")
}

// –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ —Å—Ç–∏–ª—è–º (–¥–ª—è —É–º–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π)
model StylePreference {
  id        String   @id @default(cuid())
  userId    String
  styleId   String
  useCount  Int      @default(0)
  lastUsed  DateTime @default(now())

  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  style     Style    @relation(fields: [styleId], references: [id], onDelete: Cascade)

  @@unique([userId, styleId])
  @@index([userId])
  @@map("style_preferences")
}

// ============================================
// –¶–í–ï–¢–û–í–´–ï –ü–ê–õ–ò–¢–†–´
// ============================================

model ColorPalette {
  id          String   @id @default(cuid())
  name        String   @unique
  slug        String   @unique
  description String?
  colors      String[] // Array of hex colors: ["#FFDAB9", "#98FF98"]
  isPremium   Boolean  @default(true)  // –í–°–ï –ø–∞–ª–∏—Ç—Ä—ã Premium
  season      String?  // "spring", "summer", "autumn", "winter"
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())

  // –°–≤—è–∑–∏
  generations Generation[]

  @@index([isPremium])
  @@map("color_palettes")
}

// ============================================
// –õ–û–ö–ê–¶–ò–ò (–§–û–ù–´)
// ============================================

model Location {
  id              String   @id @default(cuid())
  name            String   @unique
  slug            String   @unique
  description     String   @db.Text
  promptTemplate  String   @db.Text  // –ü—Ä–æ–º–ø—Ç –¥–ª—è —Ñ–æ–Ω–∞
  isPremium       Boolean  @default(false)
  iconEmoji       String?  // –≠–º–æ–¥–∑–∏ –¥–ª—è –∏–∫–æ–Ω–∫–∏
  exampleImageUrl String?
  sortOrder       Int      @default(0)
  isActive        Boolean  @default(true)
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  // –°–≤—è–∑–∏
  generations     Generation[]

  @@index([isPremium])
  @@index([isActive])
  @@map("locations")
}

// ============================================
// –ì–ï–ù–ï–†–ê–¶–ò–ò –û–ë–†–ê–ó–û–í
// ============================================

model Generation {
  id                String   @id @default(cuid())
  userId            String
  styleId           String
  paletteId         String?
  locationId        String?  // ID –ª–æ–∫–∞—Ü–∏–∏ (—Ñ–æ–Ω–∞)

  // URLs –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
  originalPhotoUrl  String   // –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Ñ–æ—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  processedPhotoUrl String   // –§–æ—Ç–æ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è —Ñ–æ–Ω–∞
  resultImageUrl    String   // –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–±—Ä–∞–∑

  // –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
  prompt            String   @db.Text
  replicateId       String?  // ID –∑–∞–¥–∞—á–∏ –≤ Replicate
  generationTime    Int?     // –í—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤ –º—Å

  // –°—Ç–∞—Ç—É—Å
  status            GenerationStatus @default(PENDING)
  error             String?  @db.Text

  // Timestamps
  createdAt         DateTime @default(now())
  expiresAt         DateTime? // –î–ª—è FREE –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (30 –¥–Ω–µ–π)

  // –°–≤—è–∑–∏
  user              User            @relation(fields: [userId], references: [id], onDelete: Cascade)
  style             Style           @relation(fields: [styleId], references: [id])
  palette           ColorPalette?   @relation(fields: [paletteId], references: [id])
  location          Location?       @relation(fields: [locationId], references: [id])
  favorite          Favorite?
  collectionItems   CollectionItem[]

  @@index([userId])
  @@index([styleId])
  @@index([createdAt])
  @@index([expiresAt])
  @@map("generations")
}

enum GenerationStatus {
  PENDING
  PROCESSING
  COMPLETED
  FAILED
}

// ============================================
// –ò–ó–ë–†–ê–ù–ù–û–ï –ò –ö–û–õ–õ–ï–ö–¶–ò–ò
// ============================================

model Favorite {
  id           String     @id @default(cuid())
  userId       String
  generationId String     @unique
  createdAt    DateTime   @default(now())

  user         User       @relation(fields: [userId], references: [id], onDelete: Cascade)
  generation   Generation @relation(fields: [generationId], references: [id], onDelete: Cascade)

  @@unique([userId, generationId])
  @@index([userId])
  @@map("favorites")
}

model Collection {
  id          String           @id @default(cuid())
  userId      String
  name        String
  description String?
  createdAt   DateTime         @default(now())
  updatedAt   DateTime         @updatedAt

  user        User             @relation(fields: [userId], references: [id], onDelete: Cascade)
  items       CollectionItem[]

  @@index([userId])
  @@map("collections")
}

model CollectionItem {
  id           String     @id @default(cuid())
  collectionId String
  generationId String
  addedAt      DateTime   @default(now())

  collection   Collection @relation(fields: [collectionId], references: [id], onDelete: Cascade)
  generation   Generation @relation(fields: [generationId], references: [id], onDelete: Cascade)

  @@unique([collectionId, generationId])
  @@index([collectionId])
  @@map("collection_items")
}

// ============================================
// –õ–ò–ú–ò–¢–´ –ò –ü–û–î–ü–ò–°–ö–ò
// ============================================

model DailyLimit {
  id               String   @id @default(cuid())
  userId           String
  date             DateTime @db.Date
  generationsCount Int      @default(0)

  user             User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, date])
  @@index([userId, date])
  @@map("daily_limits")
}

model Purchase {
  id             String         @id @default(cuid())
  userId         String
  type           PurchaseType
  amount         Int            // –≤ –∫–æ–ø–µ–π–∫–∞—Ö
  currency       String         @default("RUB")
  status         PurchaseStatus @default(PENDING)

  // –î–µ—Ç–∞–ª–∏ –ø–∞–∫–µ—Ç–∞
  packageType    PackageType?
  generationsAdded Int?

  // –î–µ—Ç–∞–ª–∏ –ø–æ–¥–ø–∏—Å–∫–∏
  subscriptionPeriod String?    // "month", "lifetime"
  subscriptionEndDate DateTime?

  // –ü–ª–∞—Ç–µ–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
  paymentProvider String?       // "yukassa", "manual"
  paymentId       String?       // ID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

  createdAt      DateTime       @default(now())
  paidAt         DateTime?

  @@index([userId])
  @@index([status])
  @@map("purchases")
}

enum PurchaseType {
  PACKAGE
  SUBSCRIPTION
  LIFETIME
}

enum PackageType {
  PACK_20   // 20 –≥–µ–Ω–µ—Ä–∞—Ü–∏–π
  PACK_100  // 100 –≥–µ–Ω–µ—Ä–∞—Ü–∏–π
}

enum PurchaseStatus {
  PENDING
  PAID
  FAILED
  REFUNDED
}

// ============================================
// –î–û–°–¢–ò–ñ–ï–ù–ò–Ø –ò –ì–ï–ô–ú–ò–§–ò–ö–ê–¶–ò–Ø
// ============================================

model Achievement {
  id          String   @id @default(cuid())
  slug        String   @unique
  name        String
  description String
  icon        String   // Emoji –∏–ª–∏ URL
  requirement String   @db.Text // JSON —Å —É—Å–ª–æ–≤–∏—è–º–∏
  sortOrder   Int      @default(0)
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())

  // –°–≤—è–∑–∏
  userAchievements UserAchievement[]

  @@map("achievements")
}

model UserAchievement {
  id            String      @id @default(cuid())
  userId        String
  achievementId String
  unlockedAt    DateTime    @default(now())

  user          User        @relation(fields: [userId], references: [id], onDelete: Cascade)
  achievement   Achievement @relation(fields: [achievementId], references: [id], onDelete: Cascade)

  @@unique([userId, achievementId])
  @@index([userId])
  @@map("user_achievements")
}

// ============================================
// AI –ß–ê–¢-–ë–û–¢ –°–¢–ò–õ–ò–°–¢
// ============================================

model ChatMessage {
  id        String   @id @default(cuid())
  userId    String
  role      String   // "user" –∏–ª–∏ "assistant"
  content   String   @db.Text
  createdAt DateTime @default(now())

  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([createdAt])
  @@map("chat_messages")
}

// ============================================
// –†–ï–§–ï–†–ê–õ–¨–ù–ê–Ø –ü–†–û–ì–†–ê–ú–ú–ê
// ============================================

model Referral {
  id              String   @id @default(cuid())
  referrerId      String   // –ö—Ç–æ –ø—Ä–∏–≥–ª–∞—Å–∏–ª
  referredUserId  String   @unique // –ö–æ–≥–æ –ø—Ä–∏–≥–ª–∞—Å–∏–ª
  bonusGranted    Boolean  @default(false)
  createdAt       DateTime @default(now())
  activatedAt     DateTime? // –ö–æ–≥–¥–∞ —Ä–µ—Ñ–µ—Ä–∞–ª —Å–¥–µ–ª–∞–ª –ø–µ—Ä–≤—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é

  @@index([referrerId])
  @@map("referrals")
}

// ============================================
// –ê–ù–ê–õ–ò–¢–ò–ö–ê –ò –ú–ï–¢–†–ò–ö–ò
// ============================================

model AnalyticsEvent {
  id         String   @id @default(cuid())
  userId     String?
  event      String   // "generation_created", "style_selected", "premium_purchased"
  properties Json?    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
  createdAt  DateTime @default(now())

  @@index([event])
  @@index([createdAt])
  @@map("analytics_events")
}

// ============================================
// –°–ò–°–¢–ï–ú–ê –£–í–ï–î–û–ú–õ–ï–ù–ò–ô
// ============================================

model Notification {
  id        String   @id @default(cuid())
  userId    String
  type      String   // "achievement", "bonus", "subscription_expiring"
  title     String
  message   String   @db.Text
  isRead    Boolean  @default(false)
  createdAt DateTime @default(now())

  @@index([userId, isRead])
  @@map("notifications")
}
```

---

## üîó –î–ò–ê–ì–†–ê–ú–ú–ê –°–í–Ø–ó–ï–ô –ë–î

```
User (—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞)
‚îú‚îÄ‚îÄ Account (1:N) - OAuth –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã
‚îú‚îÄ‚îÄ Session (1:N) - –°–µ—Å—Å–∏–∏ NextAuth
‚îú‚îÄ‚îÄ Generation (1:N) - –í—Å–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îú‚îÄ‚îÄ Favorite (1:N) - –ò–∑–±—Ä–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–∑—ã
‚îú‚îÄ‚îÄ Collection (1:N) - –ö–æ–ª–ª–µ–∫—Ü–∏–∏ –æ–±—Ä–∞–∑–æ–≤
‚îú‚îÄ‚îÄ DailyLimit (1:N) - –õ–∏–º–∏—Ç—ã –ø–æ –¥–Ω—è–º
‚îú‚îÄ‚îÄ UserAchievement (1:N) - –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ StylePreference (1:N) - –ü—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è —Å—Ç–∏–ª–µ–π
‚îî‚îÄ‚îÄ ChatMessage (1:N) - –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞ —Å AI

Generation
‚îú‚îÄ‚îÄ User (N:1) - –í–ª–∞–¥–µ–ª–µ—Ü
‚îú‚îÄ‚îÄ Style (N:1) - –í—ã–±—Ä–∞–Ω–Ω—ã–π —Å—Ç–∏–ª—å
‚îú‚îÄ‚îÄ ColorPalette (N:1, optional) - –¶–≤–µ—Ç–æ–≤–∞—è –ø–∞–ª–∏—Ç—Ä–∞
‚îú‚îÄ‚îÄ Location (N:1, optional) - –í—ã–±—Ä–∞–Ω–Ω–∞—è –ª–æ–∫–∞—Ü–∏—è/—Ñ–æ–Ω
‚îú‚îÄ‚îÄ Favorite (1:1, optional) - –ï—Å–ª–∏ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–º
‚îî‚îÄ‚îÄ CollectionItem (1:N) - –ú–æ–∂–µ—Ç –±—ã—Ç—å –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–æ–ª–ª–µ–∫—Ü–∏—è—Ö

Collection
‚îú‚îÄ‚îÄ User (N:1) - –í–ª–∞–¥–µ–ª–µ—Ü –∫–æ–ª–ª–µ–∫—Ü–∏–∏
‚îî‚îÄ‚îÄ CollectionItem (1:N) - –û–±—Ä–∞–∑—ã –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏

CollectionItem
‚îú‚îÄ‚îÄ Collection (N:1)
‚îî‚îÄ‚îÄ Generation (N:1)
```

---

## üöÄ API ENDPOINTS

### **1. AUTHENTICATION**

#### `POST /api/auth/[...nextauth]`
**NextAuth.js endpoints:**
- `/api/auth/signin` - –í—Ö–æ–¥
- `/api/auth/signout` - –í—ã—Ö–æ–¥
- `/api/auth/callback/:provider` - OAuth callback
- `/api/auth/session` - –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â—É—é —Å–µ—Å—Å–∏—é

**–ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã:**
- VK OAuth
- Yandex OAuth
- Email/Password (Credentials)

---

### **2. –ì–ï–ù–ï–†–ê–¶–ò–Ø –û–ë–†–ê–ó–û–í**

#### `POST /api/generate`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –æ–±—Ä–∞–∑–∞

**Request Body:**
```typescript
{
  originalPhotoBase64: string,      // Base64 —Ñ–æ—Ç–æ –±–µ–∑ —Ñ–æ–Ω–∞
  styleId: string,                  // ID —Å—Ç–∏–ª—è
  paletteId?: string,               // ID –ø–∞–ª–∏—Ç—Ä—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  locationId?: string,              // ID –ª–æ–∫–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é "—Å—Ç—É–¥–∏—è")
}
```

**–õ–æ–≥–∏–∫–∞:**
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (NextAuth session)
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤:
   - FREE: 3/–¥–µ–Ω—å + –±–æ–Ω—É—Å–Ω—ã–µ
   - PREMIUM: –±–µ–∑–ª–∏–º–∏—Ç
3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –ª–æ–∫–∞—Ü–∏–∏:
   - FREE: —Ç–æ–ª—å–∫–æ "—Å—Ç—É–¥–∏—è"
   - PREMIUM: –≤—Å–µ –ª–æ–∫–∞—Ü–∏–∏
4. –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ –≤ Yandex Object Storage (–ø–∞–ø–∫–∞ `user-uploads/`)
5. –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è —Å—Ç–∏–ª—è + –ø–∞–ª–∏—Ç—Ä—ã + –ª–æ–∫–∞—Ü–∏–∏
5. –í—ã–∑–æ–≤ Replicate API (Flux Schnell):
   ```javascript
   const output = await replicate.run(
     "black-forest-labs/flux-schnell",
     {
       input: {
         prompt: fullPrompt,
         num_outputs: 1,
         aspect_ratio: "9:16"
       }
     }
   );
   ```
6. –ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ Yandex Storage (–ø–∞–ø–∫–∞ `generated-images/`)
7. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –ë–î:
   - `Generation` —Å URLs
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `DailyLimit.generationsCount`
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `User.totalGenerations`
   - –°–æ–∑–¥–∞–Ω–∏–µ `AnalyticsEvent`
8. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π (10 –æ–±—Ä–∞–∑–æ–≤, 5 —Å—Ç–∏–ª–µ–π)
9. –í–æ–∑–≤—Ä–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

**Response:**
```typescript
{
  success: true,
  generation: {
    id: string,
    resultImageUrl: string,
    style: { name, description },
    createdAt: string
  }
}
```

**–û—à–∏–±–∫–∏:**
- 401: Not authenticated
- 429: Daily limit exceeded
- 402: Premium required (–¥–ª—è premium —Å—Ç–∏–ª–µ–π)
- 500: Generation failed

---

#### `GET /api/generations`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**Query params:**
```
?page=1&limit=20&styleId=xxx&onlyFavorites=true&sortBy=createdAt
```

**Response:**
```typescript
{
  generations: Generation[],
  total: number,
  page: number,
  hasMore: boolean
}
```

---

#### `GET /api/generations/:id`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª—É—á–∏—Ç—å –æ–¥–Ω—É –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –ø–æ ID

**Response:**
```typescript
{
  generation: Generation & {
    style: Style,
    palette: ColorPalette,
    isFavorite: boolean,
    collections: Collection[]
  }
}
```

---

#### `DELETE /api/generations/:id`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é

**–õ–æ–≥–∏–∫–∞:**
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–ª–∞–¥–µ–Ω–∏—è (userId === generation.userId)
2. –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏–∑ Yandex Storage
3. –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –ë–î (cascade —É–¥–∞–ª–∏—Ç —Å–≤—è–∑–∏)

---

### **3. –°–¢–ò–õ–ò**

#### `GET /api/styles`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å—Ç–∏–ª–µ–π

**Query params:**
```
?includeInactive=false
```

**Response:**
```typescript
{
  styles: Style[]
}
```

**–õ–æ–≥–∏–∫–∞:**
- FREE –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç –≤—Å–µ, –Ω–æ –ø—Ä–µ–º–∏—É–º –ø–æ–º–µ—á–µ–Ω—ã `isPremium: true`
- Frontend —Å–∞–º —Ä–µ—à–∞–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å –∑–∞–º–æ—á–∫–æ–º –∏–ª–∏ –Ω–µ—Ç

---

#### `GET /api/styles/recommended`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –£–º–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Å—Ç–∏–ª–µ–π

**–õ–æ–≥–∏–∫–∞:**
1. –ü–æ–ª—É—á–∏—Ç—å `StylePreference` –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ç–æ–ø-3 –ø–æ useCount)
2. –ù–∞–π—Ç–∏ –ø–æ—Ö–æ–∂–∏–µ —Å—Ç–∏–ª–∏ –ø–æ category
3. –í–µ—Ä–Ω—É—Ç—å 5 —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

**Response:**
```typescript
{
  recommended: Style[]
}
```

---

### **4. –¶–í–ï–¢–û–í–´–ï –ü–ê–õ–ò–¢–†–´**

#### `GET /api/palettes`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª—É—á–∏—Ç—å —Ü–≤–µ—Ç–æ–≤—ã–µ –ø–∞–ª–∏—Ç—Ä—ã

**Response:**
```typescript
{
  palettes: ColorPalette[]
}
```

---

### **5. –õ–û–ö–ê–¶–ò–ò (–§–û–ù–´)**

#### `GET /api/locations`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ª–æ–∫–∞—Ü–∏–π

**Response:**
```typescript
{
  locations: Location[]
}
```

**–õ–æ–≥–∏–∫–∞:**
- FREE –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç –≤—Å–µ, –Ω–æ –ø—Ä–µ–º–∏—É–º –ø–æ–º–µ—á–µ–Ω—ã `isPremium: true`
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é "—Å—Ç—É–¥–∏—è" (isPremium: false)
- Frontend –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—ã–±–æ—Ä premium –ª–æ–∫–∞—Ü–∏–π –¥–ª—è FREE –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö:**
```typescript
[
  {
    id: "loc_1",
    name: "–°—Ç—É–¥–∏—è",
    slug: "studio",
    description: "–û–¥–Ω–æ—Ç–æ–Ω–Ω—ã–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ñ–æ–Ω",
    isPremium: false,
    iconEmoji: "üé®",
    promptTemplate: "plain studio background, solid color backdrop, professional photo studio setting"
  },
  {
    id: "loc_2",
    name: "–ì–æ—Ä–æ–¥ (–¥–µ–Ω—å)",
    slug: "city-day",
    description: "–ì–æ—Ä–æ–¥—Å–∫–∞—è —É–ª–∏—Ü–∞ –≤ –¥–Ω–µ–≤–Ω–æ–µ –≤—Ä–µ–º—è",
    isPremium: true,
    iconEmoji: "üåÜ",
    promptTemplate: "urban city street background, daytime, modern cityscape, sunny day"
  },
  {
    id: "loc_3",
    name: "–ì–æ—Ä–æ–¥ (–Ω–æ—á—å)",
    slug: "city-night",
    description: "–ì–æ—Ä–æ–¥—Å–∫–∞—è —É–ª–∏—Ü–∞ –Ω–æ—á—å—é —Å –æ–≥–Ω—è–º–∏",
    isPremium: true,
    iconEmoji: "üåÉ",
    promptTemplate: "urban city street at night, evening lights, neon signs, night cityscape"
  },
  {
    id: "loc_4",
    name: "–ü–æ–¥–∏—É–º",
    slug: "runway",
    description: "–ü–æ–¥–∏—É–º –º–æ–¥–Ω–æ–≥–æ –ø–æ–∫–∞–∑–∞",
    isPremium: true,
    iconEmoji: "‚ú®",
    promptTemplate: "fashion runway background, catwalk, spotlights, fashion show setting"
  }
]
```

---

### **6. –ò–ó–ë–†–ê–ù–ù–û–ï**

#### `POST /api/favorites`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ

**Request:**
```typescript
{
  generationId: string
}
```

**–õ–æ–≥–∏–∫–∞:**
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞:
   - FREE: max 10
   - PREMIUM: –±–µ–∑–ª–∏–º–∏—Ç
2. –°–æ–∑–¥–∞–Ω–∏–µ `Favorite`
3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è "–ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä"

**–û—à–∏–±–∫–∏:**
- 402: Limit reached (FREE)

---

#### `DELETE /api/favorites/:generationId`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ

---

#### `GET /api/favorites`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ

**Response:**
```typescript
{
  favorites: (Favorite & { generation: Generation })[]
}
```

---

### **7. –ö–û–õ–õ–ï–ö–¶–ò–ò**

#### `POST /api/collections`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é

**Request:**
```typescript
{
  name: string,
  description?: string
}
```

---

#### `GET /api/collections`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª—É—á–∏—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**Response:**
```typescript
{
  collections: (Collection & {
    _count: { items: number }
  })[]
}
```

---

#### `POST /api/collections/:id/items`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–∑ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é

**Request:**
```typescript
{
  generationId: string
}
```

---

#### `DELETE /api/collections/:id/items/:itemId`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å –æ–±—Ä–∞–∑ –∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–∏

---

### **8. –õ–ò–ú–ò–¢–´**

#### `GET /api/limits/daily`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –ª–∏–º–∏—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**Response:**
```typescript
{
  subscriptionType: "FREE" | "PREMIUM" | "LIFETIME",
  dailyLimit: 3 | null,  // null –¥–ª—è premium
  usedToday: number,
  remaining: number | "unlimited",
  bonusGenerations: number,
  resetsAt: string  // ISO date –∑–∞–≤—Ç—Ä–∞—à–Ω–µ–≥–æ –¥–Ω—è
}
```

---

### **9. –î–û–°–¢–ò–ñ–ï–ù–ò–Ø**

#### `GET /api/achievements`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**Response:**
```typescript
{
  achievements: Achievement[],
  userAchievements: UserAchievement[],
  progress: {
    stylist: { current: 7, required: 10 },
    collector: { current: 25, required: 50 },
    explorer: { current: 3, required: 5 }
  }
}
```

---

#### `POST /api/achievements/check`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –≤—ã–¥–∞—Ç—å –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è (internal)

**–í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ:**
- –°–æ–∑–¥–∞–Ω–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- –î–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
- –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –¥—Ä—É–≥–∞

**–õ–æ–≥–∏–∫–∞:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å–ª–æ–≤–∏—è –¥–ª—è –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
2. –°–æ–∑–¥–∞—Ç—å `UserAchievement` –µ—Å–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
3. –°–æ–∑–¥–∞—Ç—å `Notification` —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π –∫–æ–Ω—Ñ–µ—Ç—Ç–∏

---

### **10. –†–ï–§–ï–†–ê–õ–¨–ù–ê–Ø –ü–†–û–ì–†–ê–ú–ú–ê**

#### `POST /api/referrals/activate`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –±–æ–Ω—É—Å

**Request:**
```typescript
{
  referralCode: string  // –ò–∑ URL ?ref=xxx
}
```

**–õ–æ–≥–∏–∫–∞:**
1. –ü—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å `User.referredBy = referralCode`
2. –°–æ–∑–¥–∞—Ç—å `Referral` —Å `bonusGranted: false`
3. –ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (`POST /api/generate`):
   - –ù–∞–π—Ç–∏ `Referral` –≥–¥–µ `referredUserId = currentUser.id`
   - –ï—Å–ª–∏ `!bonusGranted`:
     - –î–∞—Ç—å +5 –≥–µ–Ω–µ—Ä–∞—Ü–∏–π —Ä–µ—Ñ–µ—Ä–µ—Ä—É
     - –î–∞—Ç—å +5 –≥–µ–Ω–µ—Ä–∞—Ü–∏–π —Ç–µ–∫—É—â–µ–º—É —é–∑–µ—Ä—É
     - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `bonusGranted: true`
     - –°–æ–∑–¥–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–±–æ–∏–º

---

#### `GET /api/referrals/stats`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã

**Response:**
```typescript
{
  referralCode: string,
  totalReferrals: number,
  activeReferrals: number,  // –ö—Ç–æ —Å–¥–µ–ª–∞–ª –≥–µ–Ω–µ—Ä–∞—Ü–∏—é
  bonusEarned: number  // –í—Å–µ–≥–æ –±–æ–Ω—É—Å–Ω—ã—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–π
}
```

---

### **11. –ü–û–î–ü–ò–°–ö–ò –ò –ü–õ–ê–¢–ï–ñ–ò**

#### `POST /api/subscriptions/checkout`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å —Å–µ—Å—Å–∏—é –æ–ø–ª–∞—Ç—ã

**Request:**
```typescript
{
  type: "PREMIUM" | "LIFETIME" | "PACKAGE",
  packageType?: "PACK_20" | "PACK_100"
}
```

**–õ–æ–≥–∏–∫–∞:**
1. –°–æ–∑–¥–∞—Ç—å `Purchase` –≤ —Å—Ç–∞—Ç—É—Å–µ PENDING
2. –°–æ–∑–¥–∞—Ç—å –ÆKassa –ø–ª–∞—Ç–µ–∂:
   ```javascript
   const payment = await yukassa.createPayment({
     amount: { value: "199.00", currency: "RUB" },
     confirmation: {
       type: "redirect",
       return_url: `${siteUrl}/subscription/success`
     },
     metadata: { purchaseId: purchase.id }
   });
   ```
3. –í–µ—Ä–Ω—É—Ç—å URL –¥–ª—è —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞

**Response:**
```typescript
{
  paymentUrl: string
}
```

---

#### `POST /api/webhooks/yukassa`
**–û–ø–∏—Å–∞–Ω–∏–µ:** Webhook –æ—Ç –ÆKassa

**–õ–æ–≥–∏–∫–∞:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å—å –∑–∞–ø—Ä–æ—Å–∞
2. –ù–∞–π—Ç–∏ `Purchase` –ø–æ metadata.purchaseId
3. –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –Ω–∞ PAID
4. –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞:
   - **PREMIUM:** –æ–±–Ω–æ–≤–∏—Ç—å `User.subscriptionType`, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `subscriptionEndDate`
   - **LIFETIME:** —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `User.lifetimeAccess = true`
   - **PACKAGE:** –¥–æ–±–∞–≤–∏—Ç—å `User.bonusGenerations`
5. –°–æ–∑–¥–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
6. –û—Ç–ø—Ä–∞–≤–∏—Ç—å email –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

#### `GET /api/subscriptions/status`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏

**Response:**
```typescript
{
  type: "FREE" | "PREMIUM" | "LIFETIME",
  endDate?: string,
  daysRemaining?: number,
  canUpgrade: boolean
}
```

---

#### `POST /api/subscriptions/cancel`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –û—Ç–º–µ–Ω–∞ –ø–æ–¥–ø–∏—Å–∫–∏ (–µ—Å–ª–∏ recurring)

---

### **12. AI –ß–ê–¢-–ë–û–¢ –°–¢–ò–õ–ò–°–¢**

#### `POST /api/chat/send`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ —Å—Ç–∏–ª–∏—Å—Ç—É

**Request:**
```typescript
{
  message: string
}
```

**–õ–æ–≥–∏–∫–∞:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏–º–∏—Ç:
   - FREE: 3 –≤–æ–ø—Ä–æ—Å–∞/–¥–µ–Ω—å
   - PREMIUM: –±–µ–∑–ª–∏–º–∏—Ç
2. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å `ChatMessage` —Å role="user"
3. –ü–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 10 —Å–æ–æ–±—â–µ–Ω–∏–π
4. –í—ã–∑–≤–∞—Ç—å OpenAI GPT-4 mini:
   ```javascript
   const completion = await openai.chat.completions.create({
     model: "gpt-4-mini",
     messages: [
       {
         role: "system",
         content: "–¢—ã –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª–∏—Å—Ç. –ü–æ–º–æ–≥–∞–µ—à—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º..."
       },
       ...history,
       { role: "user", content: message }
     ]
   });
   ```
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Ç–≤–µ—Ç –∫–∞–∫ `ChatMessage` —Å role="assistant"
6. –í–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç

**Response:**
```typescript
{
  reply: string
}
```

---

#### `GET /api/chat/history`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞

**Response:**
```typescript
{
  messages: ChatMessage[]
}
```

---

### **13. –û–ë–†–ê–ó –î–õ–Ø –ü–û–î–†–£–ì–ò**

#### `POST /api/friend-outfit`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å –æ–±—Ä–∞–∑ –¥–ª—è –ø–æ–¥—Ä—É–≥–∏

**Request:**
```typescript
{
  photoBase64: string,
  styleId: string,
  paletteId?: string,
  friendName?: string
}
```

**–õ–æ–≥–∏–∫–∞:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏–º–∏—Ç:
   - FREE: 1 —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é
   - PREMIUM: –±–µ–∑–ª–∏–º–∏—Ç
2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ `/api/generate`)
3. –°–æ–∑–¥–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É –¥–ª—è —à–∞—Ä–∏–Ω–≥–∞
4. –ù–ï —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ –ë–î –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∏–ª–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ)

**Response:**
```typescript
{
  shareUrl: string,  // looklikeme.ru/shared/xxx
  imageUrl: string
}
```

---

#### `GET /api/shared/:id`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–ª—É—á–∏—Ç—å —Ä–∞—Å—à–∞—Ä–µ–Ω–Ω—ã–π –æ–±—Ä–∞–∑

**Response:**
- HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –æ–±—Ä–∞–∑–æ–º
- –ö–Ω–æ–ø–∫–∞ "–°–æ–∑–¥–∞—Ç—å —Å–≤–æ–π –æ–±—Ä–∞–∑" ‚Üí —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è

---

### **14. –ü–û–î–ï–õ–ò–¢–¨–°–Ø**

#### `POST /api/share/generate`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å —Å—Å—ã–ª–∫—É –¥–ª—è —à–∞—Ä–∏–Ω–≥–∞

**Request:**
```typescript
{
  generationId: string,
  platform: "vk" | "telegram" | "whatsapp" | "instagram"
}
```

**–õ–æ–≥–∏–∫–∞:**
1. –ü–æ–ª—É—á–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é
2. –ï—Å–ª–∏ FREE –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:
   - –ù–∞–ª–æ–∂–∏—Ç—å watermark –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤–µ—Ä—Å–∏—é —Å watermark
3. –°–æ–∑–¥–∞—Ç—å shareable URL
4. –í–µ—Ä–Ω—É—Ç—å URL –¥–ª—è —à–∞—Ä–∏–Ω–≥–∞

**Response:**
```typescript
{
  shareUrl: string,
  imageUrl: string
}
```

---

### **15. –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨ (–§–∞–∑–∞ 2)**

#### `GET /api/admin/stats`
**–û–ø–∏—Å–∞–Ω–∏–µ:** –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

**–¢—Ä–µ–±—É–µ—Ç:** `User.role = "ADMIN"`

**Response:**
```typescript
{
  totalUsers: number,
  totalGenerations: number,
  activeSubscriptions: number,
  revenue: number,
  topStyles: { name: string, count: number }[]
}
```

---

## üìÅ –°–¢–†–£–ö–¢–£–†–ê –§–ê–ô–õ–û–í –ü–†–û–ï–ö–¢–ê

```
looklikeme/
‚îú‚îÄ‚îÄ app/                                # Next.js 14 App Router
‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx                      # Root layout (fonts, theme provider)
‚îÇ   ‚îú‚îÄ‚îÄ page.tsx                        # –ì–ª–∞–≤–Ω–∞—è (–¥–µ–º–æ –∏–ª–∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç)
‚îÇ   ‚îú‚îÄ‚îÄ globals.css                     # Tailwind imports
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ (auth)/                         # Auth routes group
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ login/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ page.tsx                # –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ª–æ–≥–∏–Ω–∞
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ (dashboard)/                    # Dashboard routes (require auth)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx                  # Dashboard layout (sidebar, nav)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ generate/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx                # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ my-images/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx                # –ú–æ–∏ –æ–±—Ä–∞–∑—ã —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ favorites/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx                # –ò–∑–±—Ä–∞–Ω–Ω–æ–µ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ profile/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx                # –ü—Ä–æ—Ñ–∏–ª—å + –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ subscription/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ page.tsx                # –ü–æ–¥–ø–∏—Å–∫–∏ –∏ –æ–ø–ª–∞—Ç–∞
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ shared/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ [id]/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ page.tsx                # –ü—É–±–ª–∏—á–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –æ–±—Ä–∞–∑–∞
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ api/                            # API Routes
‚îÇ       ‚îú‚îÄ‚îÄ auth/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ [...nextauth]/
‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ route.ts            # NextAuth config
‚îÇ       ‚îú‚îÄ‚îÄ generate/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ route.ts                # POST —Å–æ–∑–¥–∞–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
‚îÇ       ‚îú‚îÄ‚îÄ generations/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ route.ts                # GET —Å–ø–∏—Å–æ–∫
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ [id]/
‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ route.ts            # GET/DELETE –æ–¥–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
‚îÇ       ‚îú‚îÄ‚îÄ styles/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ route.ts                # GET —Å–ø–∏—Å–æ–∫ —Å—Ç–∏–ª–µ–π
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ recommended/
‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ route.ts            # GET —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
‚îÇ       ‚îú‚îÄ‚îÄ palettes/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ route.ts                # GET –ø–∞–ª–∏—Ç—Ä—ã
‚îÇ       ‚îú‚îÄ‚îÄ locations/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ route.ts                # GET –ª–æ–∫–∞—Ü–∏–∏
‚îÇ       ‚îú‚îÄ‚îÄ favorites/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ route.ts                # POST/GET –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ [generationId]/
‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ route.ts            # DELETE –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
‚îÇ       ‚îú‚îÄ‚îÄ collections/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ route.ts                # POST/GET –∫–æ–ª–ª–µ–∫—Ü–∏–∏
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ [id]/
‚îÇ       ‚îÇ       ‚îú‚îÄ‚îÄ route.ts            # GET/PATCH/DELETE –∫–æ–ª–ª–µ–∫—Ü–∏—è
‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ items/
‚îÇ       ‚îÇ           ‚îî‚îÄ‚îÄ route.ts        # POST/DELETE items
‚îÇ       ‚îú‚îÄ‚îÄ limits/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ daily/
‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ route.ts            # GET –ª–∏–º–∏—Ç—ã
‚îÇ       ‚îú‚îÄ‚îÄ achievements/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ route.ts                # GET –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ check/
‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ route.ts            # POST –ø—Ä–æ–≤–µ—Ä–∫–∞ (internal)
‚îÇ       ‚îú‚îÄ‚îÄ referrals/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ activate/
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ route.ts            # POST –∞–∫—Ç–∏–≤–∞—Ü–∏—è
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ stats/
‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ route.ts            # GET —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
‚îÇ       ‚îú‚îÄ‚îÄ subscriptions/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ checkout/
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ route.ts            # POST —Å–æ–∑–¥–∞—Ç—å –ø–ª–∞—Ç–µ–∂
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ status/
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ route.ts            # GET —Å—Ç–∞—Ç—É—Å –ø–æ–¥–ø–∏—Å–∫–∏
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ cancel/
‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ route.ts            # POST –æ—Ç–º–µ–Ω–∞
‚îÇ       ‚îú‚îÄ‚îÄ webhooks/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ yukassa/
‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ route.ts            # POST webhook –æ—Ç –ÆKassa
‚îÇ       ‚îú‚îÄ‚îÄ chat/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ send/
‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ route.ts            # POST —Å–æ–æ–±—â–µ–Ω–∏–µ AI
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ history/
‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ route.ts            # GET –∏—Å—Ç–æ—Ä–∏—è
‚îÇ       ‚îú‚îÄ‚îÄ friend-outfit/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ route.ts                # POST –æ–±—Ä–∞–∑ –¥–ª—è –ø–æ–¥—Ä—É–≥–∏
‚îÇ       ‚îî‚îÄ‚îÄ share/
‚îÇ           ‚îî‚îÄ‚îÄ generate/
‚îÇ               ‚îî‚îÄ‚îÄ route.ts            # POST —Å–æ–∑–¥–∞—Ç—å share —Å—Å—ã–ª–∫—É
‚îÇ
‚îú‚îÄ‚îÄ components/                         # React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ ui/                             # Shadcn/ui components
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ button.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ card.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dialog.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ input.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ progress.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ badge.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ avatar.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dropdown-menu.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ PhotoUploader.tsx              # –ó–∞–≥—Ä—É–∑–∫–∞ + preview —Ñ–æ—Ç–æ
‚îÇ   ‚îú‚îÄ‚îÄ BackgroundRemoval.tsx          # @imgly –æ–±—Ä–∞–±–æ—Ç–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ StyleSelector.tsx              # –ö–∞—Ä—Ç–æ—á–∫–∏ —Å—Ç–∏–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ ColorPaletteSelector.tsx       # –í—ã–±–æ—Ä –ø–∞–ª–∏—Ç—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ GenerationProgress.tsx         # –ü—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä —Å —Ñ–∞–∫—Ç–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ GeneratedImageCard.tsx         # –ö–∞—Ä—Ç–æ—á–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ ImageActions.tsx               # –ö–Ω–æ–ø–∫–∏ (like, share, WB)
‚îÇ   ‚îú‚îÄ‚îÄ ShareModal.tsx                 # –ú–æ–¥–∞–ª–∫–∞ —à–∞—Ä–∏–Ω–≥–∞
‚îÇ   ‚îú‚îÄ‚îÄ WBSearchButton.tsx             # –ö–Ω–æ–ø–∫–∞ WB –ø–æ–∏—Å–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ FavoriteButton.tsx             # –ö–Ω–æ–ø–∫–∞ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
‚îÇ   ‚îú‚îÄ‚îÄ CollectionSelector.tsx         # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é
‚îÇ   ‚îú‚îÄ‚îÄ AchievementCard.tsx            # –ö–∞—Ä—Ç–æ—á–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ AchievementToast.tsx           # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ + –∫–æ–Ω—Ñ–µ—Ç—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ ProgressBar.tsx                # –ü—Ä–æ–≥—Ä–µ—Å—Å –¥–æ —Ü–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ SubscriptionCard.tsx           # –ö–∞—Ä—Ç–æ—á–∫–∞ —Ç–∞—Ä–∏—Ñ–∞
‚îÇ   ‚îú‚îÄ‚îÄ PaymentButton.tsx              # –ö–Ω–æ–ø–∫–∞ –æ–ø–ª–∞—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ ReferralLink.tsx               # –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ ChatBot.tsx                    # AI —á–∞—Ç-–±–æ—Ç
‚îÇ   ‚îú‚îÄ‚îÄ EmptyState.tsx                 # –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ ThemeToggle.tsx                # Light/Dark –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å
‚îÇ   ‚îú‚îÄ‚îÄ Header.tsx                     # –®–∞–ø–∫–∞ —Å–∞–π—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ Sidebar.tsx                    # –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é (dashboard)
‚îÇ   ‚îî‚îÄ‚îÄ Footer.tsx                     # –§—É—Ç–µ—Ä
‚îÇ
‚îú‚îÄ‚îÄ lib/                                # –£—Ç–∏–ª–∏—Ç—ã –∏ –∫–æ–Ω—Ñ–∏–≥–∏
‚îÇ   ‚îú‚îÄ‚îÄ auth/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.config.ts             # NextAuth configuration
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ providers.ts               # OAuth providers (VK, Yandex)
‚îÇ   ‚îú‚îÄ‚îÄ db/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ prisma.ts                  # Prisma client singleton
‚îÇ   ‚îú‚îÄ‚îÄ ai/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ replicate.ts               # Replicate client
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ prompts.ts                 # –ü—Ä–æ–º–ø—Ç—ã –¥–ª—è —Å—Ç–∏–ª–µ–π
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ openai.ts                  # OpenAI client (–¥–ª—è —á–∞—Ç–∞)
‚îÇ   ‚îú‚îÄ‚îÄ storage/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ yandex.ts                  # Yandex Object Storage S3 client
‚îÇ   ‚îú‚îÄ‚îÄ payments/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ yukassa.ts                 # –ÆKassa client
‚îÇ   ‚îú‚îÄ‚îÄ background-removal.ts          # @imgly wrapper
‚îÇ   ‚îú‚îÄ‚îÄ analytics.ts                   # Yandex.–ú–µ—Ç—Ä–∏–∫–∞ helpers
‚îÇ   ‚îú‚îÄ‚îÄ achievements.ts                # –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ limits.ts                      # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ watermark.ts                   # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ watermark –Ω–∞ —Ñ–æ—Ç–æ
‚îÇ   ‚îú‚îÄ‚îÄ validations.ts                 # Zod schemas –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ constants.ts                   # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã (—Ü–µ–Ω—ã, –ª–∏–º–∏—Ç—ã)
‚îÇ   ‚îî‚îÄ‚îÄ utils.ts                       # –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ
‚îú‚îÄ‚îÄ hooks/                              # Custom React hooks
‚îÇ   ‚îú‚îÄ‚îÄ useAuth.ts                     # –•—É–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ useGeneration.ts               # –•—É–∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ useFavorites.ts                # –•—É–∫ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
‚îÇ   ‚îú‚îÄ‚îÄ useAchievements.ts             # –•—É–∫ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ useLimits.ts                   # –•—É–∫ –ª–∏–º–∏—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ useSubscription.ts             # –•—É–∫ –ø–æ–¥–ø–∏—Å–∫–∏
‚îÇ
‚îú‚îÄ‚îÄ types/                              # TypeScript —Ç–∏–ø—ã
‚îÇ   ‚îú‚îÄ‚îÄ index.ts                       # –û–±—â–∏–µ —Ç–∏–ø—ã
‚îÇ   ‚îú‚îÄ‚îÄ database.types.ts              # –¢–∏–ø—ã –ë–î (–≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è Prisma)
‚îÇ   ‚îî‚îÄ‚îÄ api.ts                         # API request/response —Ç–∏–ø—ã
‚îÇ
‚îú‚îÄ‚îÄ prisma/
‚îÇ   ‚îú‚îÄ‚îÄ schema.prisma                  # Prisma schema (–≤—ã—à–µ)
‚îÇ   ‚îú‚îÄ‚îÄ migrations/                    # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îÇ   ‚îî‚îÄ‚îÄ seed.ts                        # Seed –¥–∞–Ω–Ω—ã–µ (20 —Å—Ç–∏–ª–µ–π, 4 –ø–∞–ª–∏—Ç—Ä—ã)
‚îÇ
‚îú‚îÄ‚îÄ public/                             # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ demo/                      # 3 –¥–µ–º–æ —Ñ–æ—Ç–æ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ styles/                    # –ò–∫–æ–Ω–∫–∏ —Å—Ç–∏–ª–µ–π
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ achievements/              # –ò–∫–æ–Ω–∫–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ fonts/                         # –ö–∞—Å—Ç–æ–º–Ω—ã–µ —à—Ä–∏—Ñ—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ favicon.ico
‚îÇ
‚îú‚îÄ‚îÄ .env.local                          # Environment variables
‚îú‚îÄ‚îÄ .env.example                        # –ü—Ä–∏–º–µ—Ä env —Ñ–∞–π–ª–∞
‚îú‚îÄ‚îÄ next.config.mjs                     # Next.js config
‚îú‚îÄ‚îÄ tailwind.config.ts                  # Tailwind config
‚îú‚îÄ‚îÄ tsconfig.json                       # TypeScript config
‚îú‚îÄ‚îÄ package.json                        # Dependencies
‚îú‚îÄ‚îÄ components.json                     # Shadcn config
‚îú‚îÄ‚îÄ PROMPTS_LOCATIONS.md                # AI –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è –ª–æ–∫–∞—Ü–∏–π
‚îî‚îÄ‚îÄ README.md                           # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

```

---

## üîß –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–û–ù–ù–´–ï –§–ê–ô–õ–´

### `.env.local` (–ø—Ä–∏–º–µ—Ä):

```bash
# Database
DATABASE_URL="postgresql://user:password@localhost:5432/looklikeme"

# NextAuth
NEXTAUTH_URL="http://localhost:3000"
NEXTAUTH_SECRET="your-secret-key-here"

# OAuth Providers
VK_CLIENT_ID="your-vk-app-id"
VK_CLIENT_SECRET="your-vk-secret"
YANDEX_CLIENT_ID="your-yandex-id"
YANDEX_CLIENT_SECRET="your-yandex-secret"

# AI
REPLICATE_API_TOKEN="r8_xxx"
OPENAI_API_KEY="sk-xxx"  # –î–ª—è —á–∞—Ç-–±–æ—Ç–∞

# Storage
YANDEX_STORAGE_ACCESS_KEY="xxx"
YANDEX_STORAGE_SECRET_KEY="xxx"
YANDEX_STORAGE_BUCKET="looklikeme"
YANDEX_STORAGE_REGION="ru-central1"
YANDEX_STORAGE_ENDPOINT="https://storage.yandexcloud.net"

# Payments
YUKASSA_SHOP_ID="xxx"
YUKASSA_SECRET_KEY="xxx"

# App
NEXT_PUBLIC_APP_URL="https://looklikeme.ru"
```

---

### `next.config.mjs`:

```javascript
/** @type {import('next').NextConfig} */
const nextConfig = {
  images: {
    remotePatterns: [
      {
        protocol: 'https',
        hostname: 'storage.yandexcloud.net',
      },
      {
        protocol: 'https',
        hostname: 'replicate.delivery',
      },
    ],
  },

  // –î–ª—è Yandex.–ú–µ—Ç—Ä–∏–∫–∞
  async rewrites() {
    return [
      {
        source: '/metrika/:path*',
        destination: 'https://mc.yandex.ru/:path*',
      },
    ];
  },
};

export default nextConfig;
```

---

### `tailwind.config.ts`:

```typescript
import type { Config } from "tailwindcss"

const config = {
  darkMode: ["class"],
  content: [
    './pages/**/*.{ts,tsx}',
    './components/**/*.{ts,tsx}',
    './app/**/*.{ts,tsx}',
  ],
  theme: {
    extend: {
      colors: {
        // Vogue style colors
        primary: {
          DEFAULT: '#000000',  // –ß–µ—Ä–Ω—ã–π
          foreground: '#F5F5DC', // –ö—Ä–µ–º–æ–≤—ã–π
        },
        accent: {
          DEFAULT: '#D4AF37',  // –ó–æ–ª–æ—Ç–æ–π
          foreground: '#000000',
        },
        background: '#F5F5DC',
        foreground: '#000000',
      },
      fontFamily: {
        sans: ['var(--font-geist-sans)'],
        serif: ['Playfair Display', 'serif'],  // –î–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
      },
    },
  },
  plugins: [require("tailwindcss-animate")],
} satisfies Config

export default config
```

---

## üöÄ DEPLOYMENT –ù–ê VPS REG.RU

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ VPS:
- **OS:** Ubuntu 22.04 LTS
- **RAM:** –ú–∏–Ω–∏–º—É–º 2GB (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 4GB)
- **CPU:** 2 vCPU
- **Disk:** 20GB SSD
- **–¢–∞—Ä–∏—Ñ:** –û—Ç 199‚ÇΩ/–º–µ—Å—è—Ü

---

### –ü–æ—à–∞–≥–æ–≤—ã–π deployment:

#### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

```bash
# SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
ssh root@your-vps-ip

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
apt update && apt upgrade -y

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Node.js 20.x LTS
curl -fsSL https://deb.nodesource.com/setup_20.x | bash -
apt install -y nodejs

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PostgreSQL
apt install -y postgresql postgresql-contrib

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Nginx
apt install -y nginx

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PM2 (process manager)
npm install -g pm2

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Git
apt install -y git
```

---

#### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PostgreSQL

```bash
# –í—Ö–æ–¥ –≤ PostgreSQL
sudo -u postgres psql

# –°–æ–∑–¥–∞–Ω–∏–µ –ë–î –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
CREATE DATABASE looklikeme;
CREATE USER looklikeme_user WITH PASSWORD 'strong_password_here';
GRANT ALL PRIVILEGES ON DATABASE looklikeme TO looklikeme_user;
\q

# –†–∞–∑—Ä–µ—à–∏—Ç—å —É–¥–∞–ª–µ–Ω–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
# –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å /etc/postgresql/14/main/postgresql.conf
# listen_addresses = 'localhost'

# –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å /etc/postgresql/14/main/pg_hba.conf
# host    looklikeme    looklikeme_user    127.0.0.1/32    md5

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ PostgreSQL
systemctl restart postgresql
```

---

#### 3. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞
mkdir -p /var/www/looklikeme
cd /var/www/looklikeme

# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (–∏–ª–∏ –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤)
git clone https://github.com/your-username/looklikeme.git .

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm ci --production

# –°–æ–∑–¥–∞–Ω–∏–µ .env —Ñ–∞–π–ª–∞
nano .env.local

# –í—Å—Ç–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
DATABASE_URL="postgresql://looklikeme_user:strong_password_here@localhost:5432/looklikeme"
NEXTAUTH_URL="https://looklikeme.ru"
NEXTAUTH_SECRET="generate-secret-with-openssl-rand-base64-32"
# ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

# –ó–∞–ø—É—Å–∫ Prisma –º–∏–≥—Ä–∞—Ü–∏–π
npx prisma migrate deploy

# Seed –¥–∞–Ω–Ω—ã—Ö (—Å—Ç–∏–ª–∏, –ø–∞–ª–∏—Ç—Ä—ã)
npx prisma db seed

# –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
npm run build
```

---

#### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PM2

```bash
# –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
pm2 start npm --name "looklikeme" -- start

# –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ
pm2 startup
pm2 save

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
pm2 status
pm2 logs looklikeme
```

---

#### 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx (reverse proxy)

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–∞
nano /etc/nginx/sites-available/looklikeme

# –í—Å—Ç–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:
```

```nginx
server {
    listen 80;
    server_name looklikeme.ru www.looklikeme.ru;

    # Redirect to HTTPS
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name looklikeme.ru www.looklikeme.ru;

    # SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã (Let's Encrypt)
    ssl_certificate /etc/letsencrypt/live/looklikeme.ru/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/looklikeme.ru/privkey.pem;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;

    # –õ–æ–≥–∏
    access_log /var/log/nginx/looklikeme-access.log;
    error_log /var/log/nginx/looklikeme-error.log;

    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ (–¥–ª—è —Ñ–æ—Ç–æ)
    client_max_body_size 10M;

    # Proxy –∫ Next.js
    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }

    # –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏–∫–∏
    location /_next/static/ {
        proxy_pass http://localhost:3000;
        proxy_cache_valid 200 60m;
        add_header Cache-Control "public, immutable";
    }
}
```

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–º–ª–∏–Ω–∫–∞
ln -s /etc/nginx/sites-available/looklikeme /etc/nginx/sites-enabled/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥–∞
nginx -t

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ Nginx
systemctl restart nginx
```

---

#### 6. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ SSL (Let's Encrypt)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Certbot
apt install -y certbot python3-certbot-nginx

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
certbot --nginx -d looklikeme.ru -d www.looklikeme.ru

# –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
certbot renew --dry-run

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ cron
crontab -e
# –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É:
0 0 * * * certbot renew --quiet
```

---

#### 7. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Firewall

```bash
# UFW (Uncomplicated Firewall)
ufw allow ssh
ufw allow http
ufw allow https
ufw enable
ufw status
```

---

#### 8. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏

```bash
# PM2 –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
pm2 monit

# –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
pm2 logs looklikeme --lines 100

# –õ–æ–≥–∏ Nginx
tail -f /var/log/nginx/looklikeme-error.log

# –õ–æ–≥–∏ PostgreSQL
tail -f /var/log/postgresql/postgresql-14-main.log
```

---

#### 9. Backup —Å—Ç—Ä–∞—Ç–µ–≥–∏—è

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ –±—ç–∫–∞–ø–∞ –ë–î
nano /root/backup-db.sh
```

```bash
#!/bin/bash
DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/root/backups"
mkdir -p $BACKUP_DIR

# Backup PostgreSQL
pg_dump -U looklikeme_user looklikeme > $BACKUP_DIR/db_$DATE.sql

# –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –±—ç–∫–∞–ø–æ–≤ (—Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π)
find $BACKUP_DIR -name "db_*.sql" -mtime +7 -delete

echo "Backup completed: db_$DATE.sql"
```

```bash
# –ü—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
chmod +x /root/backup-db.sh

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ cron (–∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 3:00)
crontab -e
0 3 * * * /root/backup-db.sh
```

---

#### 10. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
nano /var/www/looklikeme/deploy.sh
```

```bash
#!/bin/bash
cd /var/www/looklikeme

# Git pull
git pull origin main

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–≤—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm ci --production

# –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
npx prisma migrate deploy

# Rebuild
npm run build

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ PM2
pm2 restart looklikeme

echo "Deployment completed!"
```

```bash
chmod +x deploy.sh

# –ó–∞–ø—É—Å–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
./deploy.sh
```

---

## üîç –ú–û–ù–ò–¢–û–†–ò–ù–ì –ò –ê–ù–ê–õ–ò–¢–ò–ö–ê

### –ß—Ç–æ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å:

1. **Uptime:**
   - PM2 —Å—Ç–∞—Ç—É—Å
   - Nginx —Å—Ç–∞—Ç—É—Å
   - PostgreSQL —Å—Ç–∞—Ç—É—Å

2. **Performance:**
   - Response time API
   - –í—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (Replicate)
   - CPU/RAM usage

3. **–û—à–∏–±–∫–∏:**
   - Application errors (PM2 logs)
   - Nginx errors
   - Database errors

4. **–ë–∏–∑–Ω–µ—Å –º–µ—Ç—Ä–∏–∫–∏:**
   - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏–∏
   - –ö–æ–Ω–≤–µ—Ä—Å–∏—è –≤ Premium
   - Retention rate

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:

- **PM2 Plus** (–±–µ—Å–ø–ª–∞—Ç–Ω–æ –¥–ª—è 1 —Å–µ—Ä–≤–µ—Ä–∞)
- **Sentry** (error tracking)
- **Yandex.–ú–µ—Ç—Ä–∏–∫–∞** (–∞–Ω–∞–ª–∏—Ç–∏–∫–∞)

---

## ‚ö° –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò

### 1. Database Indexes:
```sql
-- –£–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ Prisma schema —á–µ—Ä–µ–∑ @@index
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑:
SELECT * FROM pg_indexes WHERE tablename = 'generations';
```

### 2. Image Optimization:
- –°–∂–∞—Ç–∏–µ –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π (Sharp.js)
- WebP —Ñ–æ—Ä–º–∞—Ç –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
- Lazy loading

### 3. Caching:
- Next.js built-in caching
- Nginx static caching
- Redis –¥–ª—è session (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### 4. CDN:
- Yandex CDN –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏
- CloudFlare –¥–ª—è –≤—Å–µ–≥–æ —Å–∞–π—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

**–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω:** 26.01.2026
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

---

_–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥: –ù–∞—á–∞–ª–æ –∫–æ–¥–∏–Ω–≥–∞ —Å —Å–æ–∑–¥–∞–Ω–∏—è Next.js –ø—Ä–æ–µ–∫—Ç–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö._
